import Layout from "../../components/layout.js";
import { BlogFooter } from "../../components/blog/blogFooter";
import { BlogHeader } from "../../components/blog/blogHeader";

<Layout>

<BlogHeader
	title="The making of this site"
	date="21/06/2022"
	author="Lachlan Stephan"
	headMeta="Making this site"
/>

# This will cover cleaning up the commit history for a remote branch using interactive rebase

## Scenario

We are working on a feature/bug - we have quite a few 'wip' commits on the branch and/or some other useless commit message.

<br />

We would really to like to have some descriptive messages for the reviewer.

## Proposed solution

`git rebase -i "HEAD~N"`

<br />

This will have to be done in the command line I believe, you may need some familiarity with vim unless your default is set to something else.

### Example

We have:

```text
blog - wip
blog - wip
new section added
more content
```

<br />

We want:

```text
new content for rebase blog added
```

<br />

All of these commits relate to the same thing - we want to squash the last three and rename the first.

<br />

### Fixing it

```text
git rebase -i "HEAD~4"
```

<br />

Now the default editor will open and present the commits to you:

```text
pick _commitNumber_ blog -wip
pick _commitNumber_ blog -wip
pick _commitNumber_ new section added
pick _commitNumber_ more content
```

<br />

Here we have a few options to pick from. We are only using `reword` and `squash` for this simple example.

<br />

Commands:

-   p, pick
-   r, reword
-   e, edit
-   s, squash
-   f, fixup

<br />

To fix our problem we want to edit the above to look like:

<br />

**Note:** We do not actually edit the messages here.

<br />

```text
reword _commitNumber_ blog -wip
squash _commitNumber_ blog -wip
squash _commitNumber_ new section added
squash _commitNumber_ more content
```

<br />

Now we save and close. The rebase will open a new window again this time asking for the edits.

<br />

We will give the `reword` commit our new message and in this case leave the others. Save, close and at this point the interactive rebase should be complete.

<br />

### Updating the remote to reflect

This part is quite straight forward with one gotcha. If you are the only one working on this branch you should be fine to run `git push --force`. However, if you are not the only contributor you will want to run `git push --force-with-lease` as this will preserve any new commits added to the remote.

<BlogFooter />

</Layout>
